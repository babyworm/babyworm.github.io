{{- /* Usage:
  {{< youku id="XNDkzMT..." >}}
  {{< youku url="https://v.youku.com/v_show/id_XNDkzMT....html" title="Demo" >}}
  {{< youku url="https://player.youku.com/embed/XNDkzMT..." >}}
  Optional: width, height (numbers), title
*/ -}}
{{- $id := .Get "id" -}}
{{- $url := .Get "url" -}}
{{- if and (not $id) $url -}}
  {{- /* id_Xxxxx.html -> Xxxxx */ -}}
  {{- $id = replaceRE `^.*id_([A-Za-z0-9=]+).*` `${1}` $url -}}
  {{- /* or already /embed/<ID> */ -}}
  {{- if (ne (findRE `^[A-Za-z0-9=]+$` $id | len) 1) -}}
    {{- $id = replaceRE `^.*?/embed/([A-Za-z0-9=]+).*` `${1}` $url -}}
  {{- end -}}
{{- end -}}

{{- $title := .Get "title" | default "Youku Video" -}}
{{- $w := .Get "width" | default "100%" -}}
{{- $h := .Get "height" | default "360" -}}

{{- if not $id -}}
  <div class="notice notice-warning">
    <div class="notice-title">Youku</div>
    <div class="notice-body">
      Missing <code>id</code> or resolvable <code>url</code>.
    </div>
  </div>
{{- else -}}
  <div class="sc-youku" style="max-width:100%;aspect-ratio:16/9;">
    <iframe
      src="https://player.youku.com/embed/{{ $id }}"
      title="{{ $title }}"
      width="{{ $w }}" height="{{ $h }}"
      frameborder="0" allowfullscreen
      loading="lazy" referrerpolicy="strict-origin-when-cross-origin">
    </iframe>
  </div>
{{- end -}}

